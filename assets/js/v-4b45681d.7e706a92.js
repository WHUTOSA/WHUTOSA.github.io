(self.webpackChunk=self.webpackChunk||[]).push([[610],{678:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>t});const t={key:"v-4b45681d",path:"/redisson/01-DEMO%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/",title:"DEMO 环境搭建",lang:"ZH-cn",frontmatter:{title:"DEMO 环境搭建",type:"book",scopePath:"/redisson",sort:1},excerpt:"",headers:[{level:2,title:"本文目标",slug:"本文目标",children:[]},{level:2,title:"坑点速览",slug:"坑点速览",children:[]},{level:2,title:"SpringBoot 集成 Redisson",slug:"springboot-集成-redisson",children:[]},{level:2,title:"序列化和反序列化配置",slug:"序列化和反序列化配置",children:[{level:3,title:"案例一：兼容老系统 StringRedisTemplate",slug:"案例一-兼容老系统-stringredistemplate",children:[]},{level:3,title:"案例二：希望向 redis 写入不带类型信息的 JSON",slug:"案例二-希望向-redis-写入不带类型信息的-json",children:[]},{level:3,title:"案例三：希望向 redis 写入带类型信息的 JSON",slug:"案例三-希望向-redis-写入带类型信息的-json",children:[]}]}]}},617:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>Cn});var t=a(252);const e=a.p+"assets/img/2.06812ca7.png",c=a.p+"assets/img/3.b2901a71.png",o=a.p+"assets/img/4.0da65844.png",p=(0,t.Wm)("h1",{id:"demo-环境搭建",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#demo-环境搭建","aria-hidden":"true"},"#"),(0,t.Uk)(" DEMO 环境搭建")],-1),m=(0,t.Wm)("h2",{id:"本文目标",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#本文目标","aria-hidden":"true"},"#"),(0,t.Uk)(" 本文目标")],-1),l=(0,t.Wm)("p",null,"搭建一个连接单节点 redis，并能同时使用 Redisson 和 Lettuce 的 SpringBoot 环境，用于后续的学习。",-1),u=(0,t.Wm)("h2",{id:"坑点速览",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#坑点速览","aria-hidden":"true"},"#"),(0,t.Uk)(" 坑点速览")],-1),k=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"中文文档过期"),(0,t.Wm)("li",null,"需要注意序列化问题，尤其是与现有系统整合时必须设法保持序列化和反序列化行为的一致")],-1),W=(0,t.Wm)("h2",{id:"springboot-集成-redisson",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#springboot-集成-redisson","aria-hidden":"true"},"#"),(0,t.Uk)(" SpringBoot 集成 Redisson")],-1),i=(0,t.Wm)("p",null,"本文使用的 JDK 版本为 1.8，SpringBoot 版本为 2.5.0，对应的 Jackson 版本为 2.3.12，对应的 Lettuce 版本为 6.1.2.RELEASE。本文使用了 Lombok。",-1),r=(0,t.Wm)("p",null,"引入依赖（Maven）：",-1),b=(0,t.Wm)("div",{class:"language-xml ext-xml line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-xml"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("dependency")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("groupId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("org.springframework.boot"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("groupId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("artifactId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("spring-boot-starter-data-redis"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("artifactId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("dependency")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("dependency")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("groupId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("org.redisson"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("groupId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("artifactId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("redisson-spring-boot-starter"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("artifactId")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Uk)("version")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("3.15.5"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("version")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token tag"},[(0,t.Wm)("span",{class:"token punctuation"},"</"),(0,t.Uk)("dependency")]),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br")])],-1),U=(0,t.Uk)("参考官方文档（"),d={href:"https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95",target:"_blank",rel:"noopener noreferrer"},g=(0,t.Uk)("中"),A=(0,t.Uk)(" | "),E={href:"https://github.com/redisson/redisson/wiki/Table-of-Content",target:"_blank",rel:"noopener noreferrer"},R=(0,t.Uk)("英"),f=(0,t.Uk)("），配置一个 "),I=(0,t.Wm)("code",null,"RedissonClient",-1),y=(0,t.Uk)(" Bean 对象："),C=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token namespace"},[(0,t.Uk)("io"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("github"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("yuanbug"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("demo"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("utils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("json"),(0,t.Wm)("span",{class:"token punctuation"},".")]),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token namespace"},[(0,t.Uk)("org"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("redisson"),(0,t.Wm)("span",{class:"token punctuation"},".")]),(0,t.Wm)("span",{class:"token class-name"},"Redisson"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token namespace"},[(0,t.Uk)("org"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("redisson"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("api"),(0,t.Wm)("span",{class:"token punctuation"},".")]),(0,t.Wm)("span",{class:"token class-name"},"RedissonClient"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token namespace"},[(0,t.Uk)("org"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("redisson"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("codec"),(0,t.Wm)("span",{class:"token punctuation"},".")]),(0,t.Wm)("span",{class:"token class-name"},"JsonJacksonCodec"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token namespace"},[(0,t.Uk)("org"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("redisson"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("config"),(0,t.Wm)("span",{class:"token punctuation"},".")]),(0,t.Wm)("span",{class:"token class-name"},"Config"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token namespace"},[(0,t.Uk)("org"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("springframework"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("context"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("annotation"),(0,t.Wm)("span",{class:"token punctuation"},".")]),(0,t.Wm)("span",{class:"token class-name"},"Bean"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token namespace"},[(0,t.Uk)("org"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("springframework"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("context"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("annotation"),(0,t.Wm)("span",{class:"token punctuation"},".")]),(0,t.Wm)("span",{class:"token class-name"},"Configuration"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token doc-comment comment"},[(0,t.Uk)("/**\n * "),(0,t.Wm)("span",{class:"token keyword"},"@author"),(0,t.Uk)(" yuanbug\n * "),(0,t.Wm)("span",{class:"token keyword"},"@date"),(0,t.Uk)(" 2021-05-25\n */")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Configuration"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisConfig"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Bean"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedissonClient"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token class-name"},"Config"),(0,t.Uk)(" config "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Config"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        config"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"useSingleServer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setAddress"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"redis://yourHost:6379"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setPassword"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"yourPassword"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setDatabase"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"5"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// 指定Jackson序列化，并传入自定义的ObjectMapper"),(0,t.Uk)("\n        config"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"JsonJacksonCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createObjectMapper"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Redisson"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"create"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("config"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"24"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"25"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"26"),(0,t.Wm)("br")])],-1),B=(0,t.Wm)("p",null,[(0,t.Uk)("这里采用的是程序化配置而非读取文件配置，以便于实现下文将讨论的序列化配置。实际项目一般需要进行跨环境配置，可以借助 "),(0,t.Wm)("code",null,"@Value"),(0,t.Uk)("、"),(0,t.Wm)("code",null,"@ConfigurationProperties"),(0,t.Uk)(" 等注解注入动态配置信息，这里不赘述。")],-1),w=(0,t.Wm)("p",null,"写个 DEMO 跑一下看看：",-1),h=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token annotation punctuation"},"@SpringBootApplication"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TestApplication"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"extends"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"SpringBootServletInitializer"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br")])],-1),S=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token annotation punctuation"},"@SpringBootTest"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("classes "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TestApplication"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"BaseTest"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Autowired"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"protected"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedissonClient"),(0,t.Uk)(" redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Autowired"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"protected"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplateBuilder"),(0,t.Uk)(" redisTemplateBuilder"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br")])],-1),v=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedissonClientTest"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"extends"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"BaseTest"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Test"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"void"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"fuck"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// RBucket是对象桶，这里可以先看作是redisTemplate.opsForValue()"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token class-name"},"RBucket"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" fuck "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"getBucket"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"fuck"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        fuck"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"nmsl"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("fuck"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Data"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Builder"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@NoArgsConstructor"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@AllArgsConstructor"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"static"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Uk)(" a"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Uk)(" b"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"byte"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(" c"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Test"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"void"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"shit"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token class-name"},"RBucket"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" shit "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"getBucket"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"shit"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"builder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"a"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"b"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"b"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"c"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"byte"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"4"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"build"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"24"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"25"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"26"),(0,t.Wm)("br")])],-1),T=(0,t.Wm)("p",null,[(0,t.Uk)("运行 "),(0,t.Wm)("code",null,"fuck"),(0,t.Uk)(" 方法后，redis 中存储的值是带双引号的 JSON 字符串值：")],-1),Q=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:"data:image/png;base64,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IAIiEF4CGZca1apXr1e/wfff749n9Ptx4z9evQqXjvhbihEBERABERABEYgGAS+lBvtQjh09unfPbtDghPGfbywzjNpc0Zaw8eTAV+N///sLE0/6e383RmojGt8ktUIEREAEREAESiXgpa8Gfhj9bi0we1Kuu6FXz169D5WUUCtLJDhkPDRhvLHg3x+YbE0hy5BhI9icsuXLzYOHDmcKxN5SQAREQAREQAREIAIEcmOxWPJmlJSUnDq3bvI0uisCIhAxAtVOlNStm+wXv6ioyNnk/Px852WZwsXFxXpdWZmIKbEIhIuAlwso4Wq5rBUBERABERABEfCBgKSGD5BVhQiIgAiIgAhkLwFJjezte7VcBERABERABHwgIKnhA2RVIQIiIAIiIALZS0BSI3v7Xi0XAREQAREQAR8ISGr4AFlViIAIiIAIiED2EpDUyN6+V8tFQAREQAREwAcCkho+QFYVIiACIiACIpC9BCQ1srfv1XIREAEREAER8IGApIYPkFWFCIiACIiACGQvAUmN7O17tVwEREAEREAEfCAgqeEDZFUhAiIgAiIgAtlLQFIje/teLRcBERABERABHwik9RJ53vHogymqQgREQAREQAREIHoEUkuN5C+Sjh4RtUgEREAEREAERMBDAlpA8RCmihIBERABERABEXATkNRwE9G1CIiACIiACIiAhwQkNTyEqaJEQAREQAREQATcBCQ13ER0LQIiIAIiIAIi4CEBSQ0PYaooERABERABERABNwFJDTcRXYuACIiACIiACHhIQFLDQ5gqSgREQAREQAREwE1AUsNNRNciIAIiIAIiIAIeEvh/QaomDvTwMl8AAAAASUVORK5CYII=",alt:""})],-1),j=(0,t.Wm)("p",null,[(0,t.Uk)("控制台输出的反序列化结果则是普通 Java 字符串 "),(0,t.Wm)("code",null,"nmsl"),(0,t.Uk)("：")],-1),J=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:e,alt:""})],-1),O=(0,t.Wm)("p",null,[(0,t.Uk)("运行 "),(0,t.Wm)("code",null,"shit"),(0,t.Uk)(" 方法后，redis 中存储的是带类型信息且未被双引号包裹的 JSON 对象：")],-1),F=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:c,alt:""})],-1),D=(0,t.Wm)("p",null,[(0,t.Uk)("控制台输出的则是 Java 对象 "),(0,t.Wm)("code",null,"toString"),(0,t.Uk)(" 方法的结果 "),(0,t.Wm)("code",null,"RedissonClientTest.Shit(a=a, b=b, c=[0, 1, 2, 3, 4])"),(0,t.Uk)("。")],-1),M=(0,t.Wm)("p",null,"不同系统对序列化、反序列化的需求可能会不一样，例如使用二进制格式还是文本格式、字符串是否使用双引号包裹、是否带类型信息、时间对象格式化、改用 FastJson 等等。如果要在老系统中引入 Redisson，还要考虑兼容问题。所以，我们需要对 Redisson 的序列化和反序列化行为进行个性化配置。",-1),Y=(0,t.Wm)("h2",{id:"序列化和反序列化配置",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#序列化和反序列化配置","aria-hidden":"true"},"#"),(0,t.Uk)(" 序列化和反序列化配置")],-1),z=(0,t.Wm)("p",null,[(0,t.Uk)("Redisson 中使用 "),(0,t.Wm)("code",null,"Codec"),(0,t.Uk)(" 接口来指定序列化和反序列化方式，Redisson 提供了很多可直接使用的实现类：")],-1),G=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:o,alt:""})],-1),x={href:"https://github.com/redisson/redisson/wiki/4.-data-serialization",target:"_blank",rel:"noopener noreferrer"},Z=(0,t.Uk)("官方文档"),N=(0,t.Uk)("列出了最常用的 "),L=(0,t.Wm)("code",null,"Codec",-1),V=(0,t.Uk)(" 实现，值得注意的是，中文文档是过期的，最新版本有一些类已经改名了，默认使用的 "),H=(0,t.Wm)("code",null,"Codec",-1),X=(0,t.Uk)(" 也发生了变化，还新增了很多实现类。"),P=(0,t.Wm)("p",null,"本文只讨论将对象以 JSON 形式存储在 reids 中的情况，JSON 库使用 Jackson。",-1),K=(0,t.Wm)("h3",{id:"案例一-兼容老系统-stringredistemplate",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#案例一-兼容老系统-stringredistemplate","aria-hidden":"true"},"#"),(0,t.Uk)(" 案例一：兼容老系统 StringRedisTemplate")],-1),q=(0,t.Wm)("p",null,[(0,t.Uk)("假设一个现有项目未对 "),(0,t.Wm)("code",null,"RedisTemplate"),(0,t.Uk)(" 做个性化配置，只使用了 SpringBoot 自带的 "),(0,t.Wm)("code",null,"StringRedisTemplate"),(0,t.Uk)("，这个项目的 redis 读写代码可能是这样的：")],-1),_=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token annotation punctuation"},"@Autowired"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"StringRedisTemplate"),(0,t.Uk)(" redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Test"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"void"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"test"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testString"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'"我是字符串"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testString"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testNumber"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'""'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"123"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Long"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"parseLong"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testNumber"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testBoolean"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},'""'),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token boolean"},"true"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Boolean"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"valueOf"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testBoolean"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token string"},'"testObject"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"toJsonString"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"builder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"a"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"b"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"b"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"c"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"byte"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"4"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"build"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"parseObject"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testObject"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br")])],-1),$=(0,t.Wm)("p",null,"在这种情况下，所有的值，无论是字符串、数值、布尔值还是对象、数组，都会以未被双引号包裹的形式直接存储在 redis 中，并且不带类型信息。此外，byte 数组将会被转成 Base64。",-1),nn=(0,t.Wm)("p",null,[(0,t.Uk)("为兼容 "),(0,t.Wm)("code",null,"StringRedisTemplate"),(0,t.Uk)("，我们可以参照 "),(0,t.Wm)("code",null,"StringCodec"),(0,t.Uk)(" 写一个 "),(0,t.Wm)("code",null,"Codec"),(0,t.Uk)("：")],-1),sn=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Uk)("config"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"BaseCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Override"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Decoder"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"Object"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"getValueDecoder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("buf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" state"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"->"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Uk)(" str "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" buf"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"toString"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"CharsetUtil"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("UTF_8"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            buf"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"readerIndex"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("buf"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"readableBytes"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 这里返回的总是一个字符串"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" str"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Override"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Encoder"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"getValueEncoder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" object "),(0,t.Wm)("span",{class:"token operator"},"->"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token class-name"},"ByteBuf"),(0,t.Uk)(" out "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"ByteBufAllocator"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DEFAULT"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"buffer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 如果是字符序列，直接写（避免被双引号包裹），否则转JSON再写"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("object "),(0,t.Wm)("span",{class:"token keyword"},"instanceof"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CharSequence"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"writeCharSequence"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"CharSequence"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" object"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CharsetUtil"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("UTF_8"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"writeCharSequence"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"toJsonString"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("object"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CharsetUtil"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("UTF_8"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" out"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"24"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"25"),(0,t.Wm)("br")])],-1),an=(0,t.Wm)("p",null,[(0,t.Uk)("这样就可以保证 Redisson 写入 redis 的字符串与 "),(0,t.Wm)("code",null,"StringRedisTemplate"),(0,t.Uk)(" 一致。")],-1),tn=(0,t.Wm)("p",null,[(0,t.Uk)("而在读取对象和数组时，我们需要传入 "),(0,t.Wm)("code",null,"TypedJsonJacksonCodec"),(0,t.Uk)(" 来确保反序列化类型正确：")],-1),en=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token annotation punctuation"},"@Test"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"void"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"shit"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"RBucket"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" shit "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"getBucket"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"shit"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TypedJsonJacksonCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"builder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"a"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"b"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"b"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"c"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"byte"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"4"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"build"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Uk)(" value "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br")])],-1),cn=(0,t.Wm)("h3",{id:"案例二-希望向-redis-写入不带类型信息的-json",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#案例二-希望向-redis-写入不带类型信息的-json","aria-hidden":"true"},"#"),(0,t.Uk)(" 案例二：希望向 redis 写入不带类型信息的 JSON")],-1),on=(0,t.Wm)("p",null,"假设新项目要以 JSON 形式向 redis 写值，并且不希望带有类型信息，我们就必须在反序列化时指定类型。",-1),pn=(0,t.Wm)("p",null,[(0,t.Uk)("首先是 "),(0,t.Wm)("code",null,"RedissonClient"),(0,t.Uk)(" 配置，和案例一差不多：")],-1),mn=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Uk)("config"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"BaseCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Override"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Decoder"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"Object"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"getValueDecoder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("buf"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" state"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"->"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Uk)(" str "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" buf"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"toString"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"CharsetUtil"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("UTF_8"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            buf"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"readerIndex"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("buf"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"readableBytes"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 这里返回的总是一个字符串"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" str"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Override"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Encoder"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"getValueEncoder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" object "),(0,t.Wm)("span",{class:"token operator"},"->"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token class-name"},"ByteBuf"),(0,t.Uk)(" out "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"ByteBufAllocator"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DEFAULT"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"buffer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token comment"},"// 不管object是什么，都转成JSON再写，字符串将会被双引号包裹"),(0,t.Uk)("\n            out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"writeCharSequence"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"toJsonString"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("object"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"CharsetUtil"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("UTF_8"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" out"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br")])],-1),ln=(0,t.Wm)("p",null,[(0,t.Uk)("而 "),(0,t.Wm)("code",null,"RedisTemplate"),(0,t.Uk)(" 是一个泛型类。尽管 Spring 提供了泛型注入能力，但似乎并没有允许我们用泛型的方式注册 bean：")],-1),un=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token doc-comment comment"},"/**\n * 并不支持这种泛型注册写法\n */"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Bean"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"RedisConnectionFactory"),(0,t.Uk)(" redisConnectionFactory"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// TODO"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br")])],-1),kn=(0,t.Wm)("p",null,"而只能像这样分别定义每种类型的 bean：",-1),Wn=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token annotation punctuation"},"@Bean"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"A"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"aRedisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"RedisConnectionFactory"),(0,t.Uk)(" redisConnectionFactory"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// TODO"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Bean"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"B"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"bRedisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"RedisConnectionFactory"),(0,t.Uk)(" redisConnectionFactory"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// TODO"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br")])],-1),rn=(0,t.Wm)("p",null,"这应该主要是受制于 Java 泛型本身的局限性，但不管是因为什么，反正把所有类型都各写一遍，显然是难以接受的。",-1),bn=(0,t.Wm)("p",null,[(0,t.Uk)("为了解决这个问题，我们可以写一个 builder 类，自行封装一个 Map 来维护这些 "),(0,t.Wm)("code",null,"RedisTemplate"),(0,t.Uk)("：")],-1),Un=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token doc-comment comment"},[(0,t.Uk)("/**\n * 用于创建"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token keyword"},"@code"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token code-section"},[(0,t.Wm)("span",{class:"token code language-java"},[(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")])])]),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n *\n * "),(0,t.Wm)("span",{class:"token keyword"},"@author"),(0,t.Uk)(" yuanbug\n * "),(0,t.Wm)("span",{class:"token keyword"},"@date"),(0,t.Uk)(" 2021-03-22\n */")]),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Component"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplateBuilder"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token doc-comment comment"},"/**\n     * 注意这里要取Lettuce中的RedisConnectionFactory，而不是Redisson中的，两者的名称不同\n     */"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Resource"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisConnectionFactory"),(0,t.Uk)(" redisConnectionFactory"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"static"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"final"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Map"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"Class"),(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Wm)("span",{class:"token punctuation"},">"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Wm)("span",{class:"token punctuation"},">"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" REDIS_TEMPLATE_MAP "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"ConcurrentHashMap"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token annotation punctuation"},"@SuppressWarnings"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"unchecked"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"public"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"build"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Class"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" tClass"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token comment"},"// ConcurrentHashMap的computeIfAbsent是原子方法，这里不用担心RedisTemplate被创建多次（虽然创建多次其实也无伤大雅）"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(" REDIS_TEMPLATE_MAP"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"computeIfAbsent"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n                tClass"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                clazz "),(0,t.Wm)("span",{class:"token operator"},"->"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" redisTemplate "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setConnectionFactory"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("redisConnectionFactory"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n                    "),(0,t.Wm)("span",{class:"token comment"},"// key采用String序列化方式"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token class-name"},"StringRedisSerializer"),(0,t.Uk)(" stringRedisSerializer "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"StringRedisSerializer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setKeySerializer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("stringRedisSerializer"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setHashKeySerializer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("stringRedisSerializer"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n                    "),(0,t.Wm)("span",{class:"token comment"},"// value采用Jackson序列化方式"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token class-name"},"Jackson2JsonRedisSerializer"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" serializer "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Jackson2JsonRedisSerializer"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("tClass"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    serializer"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setObjectMapper"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createObjectMapper"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setValueSerializer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("serializer"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setHashValueSerializer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("serializer"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n                    redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"afterPropertiesSet"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" redisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"24"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"25"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"26"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"27"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"28"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"29"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"30"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"31"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"32"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"33"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"34"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"35"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"36"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"37"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"38"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"39"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"40"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"41"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"42"),(0,t.Wm)("br")])],-1),dn=(0,t.Wm)("p",null,"使用示例：",-1),gn=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token annotation punctuation"},"@Autowired"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedissonClient"),(0,t.Uk)(" redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Autowired"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"private"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplateBuilder"),(0,t.Uk)(" redisTemplateBuilder"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token annotation punctuation"},"@Test"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token keyword"},"void"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"testCompatibility"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"final"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Uk)(" shitValue "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"builder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"a"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"b"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"b"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"c"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"byte"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"4"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"build"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token class-name"},"RedisTemplate"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"String"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" shitRedisTemplate "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" redisTemplateBuilder"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"build"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 不向redis写入类型信息，则这里需要传TypedJsonJacksonCodec；反过来如果要向redis中写入类型信息，这里就不能传"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"RBucket"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" shitBucket "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"getBucket"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testObject"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"TypedJsonJacksonCodec"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token keyword"},"class"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// Lettuce写Redisson读"),(0,t.Uk)("\n    shitRedisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testObject"'),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" shitValue"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("shitBucket"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token comment"},"// Redisson写Lettuce读"),(0,t.Uk)("\n    shitBucket"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("shitValue"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token class-name"},"System"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("out"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"println"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("shitRedisTemplate"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"opsForValue"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"get"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testObject"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br")])],-1),An=(0,t.Wm)("h3",{id:"案例三-希望向-redis-写入带类型信息的-json",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#案例三-希望向-redis-写入带类型信息的-json","aria-hidden":"true"},"#"),(0,t.Uk)(" 案例三：希望向 redis 写入带类型信息的 JSON")],-1),En=(0,t.Wm)("p",null,"当需要向 redis 写入类型信息时，需要在方案二的基础上做两点修改。",-1),Rn=(0,t.Wm)("p",null,[(0,t.Uk)("首先，要确保 Redisson 和 Lettuce 两种客户端的序列化、反序列化行为一致，尤其是类型信息的携带方式一致。例如，配置 "),(0,t.Wm)("code",null,"RedissonClient"),(0,t.Uk)(" 的序列化可以直接使用 "),(0,t.Wm)("code",null,"JsonJacksonCodec"),(0,t.Uk)("，此时 "),(0,t.Wm)("code",null,"RedisTemplateBuilder"),(0,t.Uk)(" 需要做如下配置：")],-1),fn=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token class-name"},"Jackson2JsonRedisSerializer"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"T"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" serializer "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Jackson2JsonRedisSerializer"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("tClass"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"ObjectMapper"),(0,t.Uk)(" objectMapper "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"JsonUtils"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"createObjectMapper"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token comment"},"// 这里是对类型信息序列化的配置，采用NON_FINAL和PROPERTY可以和JsonJacksonCodec的配置选项保持一致"),(0,t.Uk)("\nobjectMapper"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"activateDefaultTyping"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"DefaultBaseTypeLimitingValidator"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("ObjectMapper"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("DefaultTyping")]),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("NON_FINAL"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},[(0,t.Uk)("JsonTypeInfo"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("As")]),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("PROPERTY"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nserializer"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"setObjectMapper"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("objectMapper"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br")])],-1),In=(0,t.Wm)("p",null,[(0,t.Uk)("其次，调用 Redisson 的 API 时，不需要传入 "),(0,t.Wm)("code",null,"TypedJsonJacksonCodec"),(0,t.Uk)(" 参数：")],-1),yn=(0,t.Wm)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-java"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"final"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Uk)(" shitValue "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"builder"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"a"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"a"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"b"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"b"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"c"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"byte"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"2"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"3"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"4"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"build"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token comment"},"// 这里不能传TypedJsonJacksonCodec，否则序列化时不会携带类型信息"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token class-name"},"RBucket"),(0,t.Wm)("span",{class:"token generics"},[(0,t.Wm)("span",{class:"token punctuation"},"<"),(0,t.Wm)("span",{class:"token class-name"},"Shit"),(0,t.Wm)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" shitBucket "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(" redissonClient"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"getBucket"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},'"testObject"'),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nshitBucket"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"set"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("shitValue"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br")])],-1),Cn={render:function(n,s){const a=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.j4)(t.HY,null,[p,m,l,u,k,W,i,r,b,(0,t.Wm)("p",null,[U,(0,t.Wm)("a",d,[g,(0,t.Wm)(a)]),A,(0,t.Wm)("a",E,[R,(0,t.Wm)(a)]),f,I,y]),C,B,w,h,S,v,T,Q,j,J,O,F,D,M,Y,z,G,(0,t.Wm)("p",null,[(0,t.Wm)("a",x,[Z,(0,t.Wm)(a)]),N,L,V,H,X]),P,K,q,_,$,nn,sn,an,tn,en,cn,on,pn,mn,ln,un,kn,Wn,rn,bn,Un,dn,gn,An,En,Rn,fn,In,yn],64)}}}}]);